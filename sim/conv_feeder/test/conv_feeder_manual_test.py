#=========================================================================
# RegArray_test
#=========================================================================

import pytest

from pymtl3 import *
from pymtl3.stdlib.test_utils import run_test_vector_sim

from conv_feeder.ConvFeeder import ConvFeeder

#-------------------------------------------------------------------------
# load full
#-------------------------------------------------------------------------

basic_test = [
  ('win_dim enq_val  enq_msg  enq_rdy*   deq_val*  deq_rdy* deq_msg*   new_row*'),
  [  1,        1,       1,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       2,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       3,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       4,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       5,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       6,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       7,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       8,     [1,1,1],      '?',     '?',        '?',   '?'],
  [  1,        1,       9,     [1,1,1],      '?',     '?', [ 7, 4, 1],   '?'],
  [  1,        0,       0,     [1,1,1],      '?',     '?', [ 8, 5, 2],   '?'],
  [  1,        0,       0,     [1,1,1],      '?',     '?', [ 9, 6, 3],   '?'],

]

#-------------------------------------------------------------------------
# test
#-------------------------------------------------------------------------

@pytest.mark.parametrize( "test_vectors", [
  basic_test
])

def test( test_vectors, cmdline_opts ):
    run_test_vector_sim( ConvFeeder(), test_vectors, cmdline_opts )

